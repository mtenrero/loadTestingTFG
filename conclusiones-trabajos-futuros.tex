\cleardoublepage
\chapter{Conclusiones y trabajos futuros}
\label{chap:conclusiones-trabajos-futuros}

\section{Resultados en tiempo real de lanzamiento con ATQ}

Para visualizar de forma más clara los resultados de los tests de carga, se puede configurar un \textit{Backend Listener} en el \textit{Test Plan} de Apache JMeter para que retransmita los resultados a un sistema externo como \textit{ElasticSearch} o \textit{InfluxDB}\footnote{https://www.influxdata.com}.\newline

Yo he decidido emplear ElasticSearch, y para ello, hay que añadir un plugin\footnote{https://github.com/delirius325/jmeter-elasticsearch-backend-listener} de JMeter al directorio \textit{./lib/ext} de la instalación de JMeter. (La imagen de JMeter creada para el uso con \gls{ATQ} ya lo incluye)\newline

Además, también es necesario configurar una serie de parámetros, como la url donde se expone la API de ElasticSearch o el índice donde guardar los resultados.\newline

Una vez que se ha configurado correctamente el \textit{Backend Listener} y se ejecuta el test, es posible consultar directamente a ElasticSearch por el estado del nuevo índice especificado\newline

\begin{lstlisting}[language=yaml]
  >HTTP GET elasticsearch:9200/test
\end{lstlisting}

O también se pueden consultar los contenidos volcados por JMeter sobre el índice:\newline
  
\begin{lstlisting}[language=yaml]
  >HTTP GET elasticsearch:9200/test/_search
\end{lstlisting}

Lo cual devolverá todos los registros de los que disponga en ese índice en formato JSON. (Apéndice B.3)

Para visualizarlo de una manera más cómoda, se puede conectar con un panel visualizador como \textit{Grafana}\footnote{https://grafana.com} o \textit{Kibana}\footnote{https://www.elastic.co/products/kibana}. Para los ejemplos, he utilizado Grafana conectado a ElasticSearch:

\begin{figure}[h]
    \centering
    \includegraphics[width=1\textwidth]{grafana1}
    \caption{Snapshot Grafana Elastic JMeter 1}
    \label{fig:grafana1}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=1\textwidth]{grafana2}
    \caption{Snapshot Grafana Elastic JMeter 2}
    \label{fig:grafana2}
\end{figure}

\section{Ampliación del Middleware}

\subsection{Sistemas Operativos Windows}

La integración completa con Sistemas Operativos Windows aún no es posible, ya que las imágenes de \gls{ATQ} para un despliegue basado en stacks de Swarm y del descubrimiento de servicios, están basados en imágenes linux, como CentOS 7\footnote{https://centos.org} o Alpine Linux\footnote{https://alpinelinux.org}. Esto implica que no se pueda desplegar \gls{ATQ} en sistemas Windows que utilicen contenedores Windows nativos, aunque sí debería poderse desplegar \gls{ATQ} sobre sistemas Windows que operen con contenedores Linux.\newline

Para ello, sería necesario crear imágenes específicas con los binarios de \gls{ATQ} y del descubridor de servicios con una imagen de contenedor basada en Windows como \textit{nanoserver}\footnote{https://hub.docker.com/r/microsoft/nanoserver/}.

\subsection{Integración con Jenkins}

Por otro lado, se podría ampliar el proyecto creando un plugin específico para Jenkins para poder así definir de una manera declarativa sencilla los parámetros para una ejecución elástica de test de carga usando el middleware \gls{ATQ}.

\subsection{Sistema de ficheros distribuidos interno}

En la actualidad, es necesario que exista un sistema de compartición de ficheros subyacente como Samba o GlusterFS para que los ficheros de test proporcionados por el usuario estén disponibles en todos los nodos que conforman el clúster de Docker Swarm.\newline

Sería interesante extender el middleware para que expongan un socket en cada nodo y poder replicar el fichero proporcionado del usuario a través de éstos sockets antes de enviarle al usuario la respuesta a su petición.\newline

De esta manera se reducirían prácticamente a cero los requisitos para poder utilizar Automation Test Queue y se prescindiría del sistema externo de ficheros distribuidos.

\subsection{Solución comercial}

Una solución empresarial sería posible creando un portal web con una serie de características como autenticación con Kerberos o \gls{LDAP} y multi-tenancy de usuarios para poder así ofrecer una solución \gls{SAAS} de la herramienta y ofrecerla a través de algún tipo de suscripción.\newline

Para ello sería necesario desplegar \gls{ATQ} sobre una infraestructura cloud como Amazon Web Services\footnote{https://aws.amazon.com}, Azure\footnote{https://azure.microsoft.com} o Google Cloud Platform\footnote{https://cloud.google.com} usando el orquestador Kubernetes\footnote{https://kubernetes.io} con el objetivo de poder escalar de una manera sencilla la infraestructura en base a la demanda de los usuarios.\clearpage

Una posible arquitectura sería la siguiente:

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{saas_arch}
    \caption{Arquitectura posible para una solución comercial SAAS}
    \label{fig:saas_arch}
\end{figure}
